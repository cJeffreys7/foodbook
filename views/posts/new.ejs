<%- include('../partials/html-head') %>

<link rel="stylesheet" href="/stylesheets/nav.css">
<link rel="stylesheet" href="/stylesheets/posts/new.css">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.min.js" integrity="sha384-Atwg2Pkwv9vp0ygtn1JAojH0nYbwNJLPhwyoVbhoPwBhjQPR5VtM2+xf0Uwh9KtT" crossorigin="anonymous"></script>

</head>
<body>
  <form action="/posts" method="POST">
    <nav>
      <a class="cancel-link" href="/">Cancel</a>
      <div>New Post</div>
      <button type="submit">Post</button>
    </nav>
    <main>
      <header>
        <img
          id="profile-img"
          src="<%= user.profile.avatar %>" 
          alt="<%= user.profile.name %> avatar"
        >
        <div><%= user.profile.name %></div>
      </header>
      <textarea id="text-input" name="text" style="resize: none;" oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"' outline="none" placeholder="What's new in the food world, <%= user.profile.name %>?"></textarea>
      <img src="" class="preview">
    </main>
  </form>
  <!-- <form action="/posts/upload" method="post">
    <input
        type="file"
        name="file"
        accept="image/png, image/jpeg"
      />
      <button type="submit">Add Photo</button>
  </form> -->

<%- include('../partials/footer') %>

<!-- <script>
  const fileInput = document.querySelector('input[type="file"]')
  const preview = document.querySelector('img.preview')

  const reader = new FileReader()

  function handleEvent(event) {
      console.log(`${event.type}: ${event.loaded} bytes transferred\n`)

      if (event.type === "load") {
          preview.src = reader.result
      }
  }

  function addListeners(reader) {
      reader.addEventListener('load', handleEvent)
  }

  function handleSelected(e) {
      const selectedFile = fileInput.files[0]
      if (selectedFile) {
          addListeners(reader)
          reader.readAsDataURL(selectedFile)
      }
  }

  fileInput.addEventListener('change', handleSelected)
</script> -->