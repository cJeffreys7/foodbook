<article>
  <header id="post-header">
    <a href="profiles/<%= post.owner._id %>">
      <img
        id="avatar-img"
        src="<%= post.owner.avatar %>" 
        alt="<%= post.owner.name %> avatar"
      >
    </a>
    <div id="post-info">
      <div>
        <%= post.owner.name %>
      </div>
      <div>
        <%= post.createdAt.toLocaleDateString() + " at " + post.createdAt.toLocaleTimeString().slice(0, -6) + post.createdAt.toLocaleTimeString().slice(-3) %> 
      </div>
    </div>
    <% if (post.owner._id.toString() === user.profile._id.toString()) { %>
      <a id="edit-link" href="/posts/<%= post._id %>/edit">Edit</a>
    <% } %>
  </header>
  <section>
    <%= post.text %> 
  </section>
  <footer>
    <div id="post-stats">
      <i class="fas fa-thumbs-up"></i>
      <i class="fas fa-comment"></i>
      <i class="fas fa-star"></i>
    </div>
    <div id="post-actions">
      <div>
        <i class="fas fa-thumbs-up"></i>
        Like
      </div>
      <div>
        <button class="comment-btn comment-btn-<%= idx %>">
          <i class="fas fa-comment"></i>
          Comment
        </button>
      </div>
      <div>
        <form action="/profiles/<%= user.profile._id %>/toggleFavorite?_method=PATCH" method="POST">
          <input type="hidden" name="postId" value="<%= post._id %>">
          <button class="btn" type="submit">
            <i class="fas fa-star"></i>
            Favorite
          </button>
        </form>
      </div>
    </div>
    <section id="post-<%= idx %>-comments" class="post-comments" style="display: none;">
      <div id="blank-comment">
        <form action="/posts/<%= post._id %>/comments" method="POST">
          <img
            id="blank-comment-avatar-img"
            src="<%= user.profile.avatar %>"
            alt="<%= user.profile.name %> avatar"
          >
          <textarea id="comment-text" name="text" style="resize: none;" oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"' outline="none" rows="2" placeholder="Add a comment..."></textarea>
          <button id="comment-btn" type="submit">
            Submit
          </button>
        </form>
      </div>
      <% post.comments.forEach(function(comment) { %>
        <%- include('../partials/comment', {comment: comment}) %>
      <% }) %>
    </section>
  </footer>
</article>

<!-- <script>
  function showComments(idx) {
      console.log('Show comments for Post Idx: need to figure out how to get post idx passed into showComments function')
      document.getElementById(`post-${idx}-comments`).style.display = "contents"
    }
</script> -->